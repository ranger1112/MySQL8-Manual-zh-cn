## 10.2.1 优化 SELECT 语句

### 目录

- [10.02.01.01 WHERE 子句优化](10.02.01.01_WHERE子句优化.md)


对于数据库中的所有查询操作来说， [SELECT] 查询语句无疑是最重要的部分。不管你是要实现动态网页的亚秒级响应，还是想要缩短生成隔夜报表的大量时间，对 [SELECT] 语句进行调优都是必不可免的。

除了 [SELECT] 语句以外，查询优化技术同样也适用于其他语句如：[CREATE TABLE..AS SELECT]、[INSERT INTO...SELECT] 以及 [WHERE] 条件下的 [DELETE] 语句。因为这些语句是将写入和读取数据相结合的操作，因此这些语句的性能不仅仅与读取语句有关。

NDB Cluster 支持 JOIN 下推优化，当一个 JOIN 语句被发送到 NDB Cluster 数据节点时，它会在节点间分发并且独立(平行)执行。此部分可以参考 [NDB JOIN 下推条件]。

查询优化的主要注意事项包括：
+ 要对 SELECT...WHERE 慢查询语句进行优化，首先要检查的就是是否可以添加 [索引]。一般来说在 WHERE 子句中使用的列上设置索引，可以加快查询。当然为了避免浪费磁盘空间，应该尽可能地构建一个小的索引集，这样才能最大化优化应用程序中的相关查询。
+ 分解查询中任何耗时过长的部分，例如函数调用。一个函数可能会在结果集的每一行中都被调用一次，甚至是表中的每一行都调用一次，这大大降低了查询效率。
+ 尽量减小 [全表扫描] 的数据量，尤其是大表。
+ 定期使用 [ANALYZE TABLE] 语句来保证数据表信息的时效性，以便优化器可以获得所需信息构建高效的执行计划。
+ 了解不同的存储引擎的优化、优化技术和配置参数。InnoDB 和 MyISAM 都有各自的一套规则用于启用或者是保证在查询中的高性能。具体可以参考 [10.5.6 优化InnoDB查询] 和 [10.6.1 优化MyISAM查询]。
+ 对于 InnoDB 表来说也可以优化单个查询事务，参考 [10.5.3 优化 InnoDB 只读事务]。
+ 如果查询优化器会执行一些既定的转化，就不要手动进行一些难以理解的转化。
+ 当性能问题无法通过一些基本地查询优化技术来解决时，通过阅读 [EXPLAIN] 计划中具体地查询细节来调整索引、JOIN 子句等等。(当你打到一定的经验时，使用 [EXPLAIN] 了解执行计划将会是构建每个查询的第一步。)
+ 调整 MySQL 用于缓存的内存区域的大小和相关参数配置。通过有效利用 InnoDB 缓冲池、MyISAM键缓存以及MySQL查询缓存，重复查询会执行地更快，因为第二次以及后续的查询会从缓存中读取数据。
+ 即便一个查询已经通过缓存进行了优化，它依然可以得到进一步地优化，从而可以减少缓存内存的使用，使应用程序更具有更高的性能。更高的性能意味着应用程序可以处理更多的并发用户、更大规模的请求量等等。
+ 处理锁问题。有些查询的速度会受到同一时刻其他查询会话的影响。
+ 
***

[上一节: 10.2 优化 SQL语句](10.02.00_优化SQL语句.md)

[本章目录](10.00_优化.md)

[下一小节：10.2.1.1 WHERE 子句优化](10.02.01.01_WHERE子句优化.md)

